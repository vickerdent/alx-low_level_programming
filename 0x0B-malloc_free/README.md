Now dealing with dynamic memory allocation
